---
title: "Kids, always remember to clear your intervals"
description: ""
published: 2014-11-05
redirect_from:
  - /blog/kids-always-remember-to-clear-your-intervals/swizec/6614
categories: "JavaScript, Node.js, socket.io, Uncategorized"
hero: ./img/images-23704.png
---

Making fake demo graphs is always fun. Here you are, making a graph without data, generating random datapoints, trying to make it as realistic as possible. Two days ago I was failing at the same. It sounds simple, right? To produce a random graph, you generate random data. Something like this:

```javascript
var data = _.range(250).map(function () {
  return Math.round(Math.random() * 100);
});
```

![Completely random graph](./img/images-23704.png "Completely random graph")![]()`250ms`

```javascript
io.on("connection", function (socket) {
  setInterval(function () {
    socket.emit("cpu", update());
  }, 250);

  function update() {
    return Math.round(Math.random() * 100);
  }
});
```

![Moving random graph](./img/images-23705.gif "Moving random graph")![]()

```javascript
io.on('connection', function (socket) {
    var previous = 0;

    setInterval(function () {
        previous = update(previous);
        socket.emit('cpu', previous);
    }, 250);

    function (previous) {
        previous += Math.random()*10-5;
        if (previous > 100) previous = 100;
        if (previous < 0) previous = 0;

        return Math.round(previous);
    }
});
```

![Fixed random graph, 1](./img/images-23706.gif "Fixed random graph, 1")![Fixed random graph, 2](./img/images-23707.gif "Fixed random graph, 2")![Fixed random graph, 3](./img/images-23708.gif "Fixed random graph, 3")\_\_` setInterval``connection `

```javascript
io.on('connection', function (socket) {
    var previous = 0;

    var interval = setInterval(function () {
        previous = update(previous);
        socket.emit('cpu', previous);
    }, 250);

    function (previous) {
        previous += Math.random()*10-5;
        if (previous > 100) previous = 100;
        if (previous < 0) previous = 0;

        return Math.round(previous);
    }

    socket.on('disconnect', function () {
        clearInterval(interval);
    });
});
```

![Moving graph, good](./img/images-23710.gif "Moving graph, good")
