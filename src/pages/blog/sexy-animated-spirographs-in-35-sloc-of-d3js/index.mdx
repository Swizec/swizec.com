---
title: "Sexy animated spirographs in 35 sloc of d3.js"
description: ""
published: 2013-03-07
redirect_from:
  - /blog/sexy-animated-spirographs-in-35-sloc-of-d3-js/swizec/6052
categories: "Animation, d3.js, JavaScript, Spirograph, Uncategorized"
hero: ../../../defaultHero.jpg
---

![Spirograph](http://upload.wikimedia.org/wikipedia/commons/thumb/9/97/Spirograph3.jpg/800px-Spirograph3.jpg "Spirograph")![]()

\>tweet gone missing&lt;

My failure in common knowledge aside, it's possible to animate the drawing of parametric equations with just a few lines of [d3.js](http://d3js.org) code. What I'm about to show you has a pretty big problem, but produces cool looking results "in the lab". Try to guess what the problem is.

## Animating spirographs

![After a few steps](http://swizec.com/blog/wp-content/uploads/2013/03/0007_04_04.png "After a few steps")

```html
<title></title>
<link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet" />

<div id="graph"></div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="timers.js"></script>
```

Then we hop into the javascript to flesh out the actual code.

```javascript
var width = 600,
  height = 600,
  svg = d3
    .select("#graph")
    .append("svg")
    .attr({ width: width, height: height });
```

I found the parametric function in the wikipedia's article on parametric equations. We'll be giving it a simple parameter calculated from the animation timer and it will return a two dimensional position.

```javascript
var position = function (t) {
  var a = 80,
    b = 1,
    c = 1,
    d = 80;

  return {
    x: Math.cos(a * t) - Math.pow(Math.cos(b * t), 3),
    y: Math.sin(c * t) - Math.pow(Math.sin(d * t), 3),
  };
};
```

Tweaking the _a_, _b_, c, and _d_ parameters will change the final shape. Next we're going to define some scales to help us translate between maths space and our drawing space.

```javascript
var t_scale = d3.scale
    .linear()
    .domain([500, 30000])
    .range([0, 2 * Math.PI]),
  x = d3.scale
    .linear()
    .domain([-2, 2])
    .range([100, width - 100]),
  y = d3.scale
    .linear()
    .domain([-2, 2])
    .range([height - 100, 100]);

var brush = svg.append("circle").attr({ r: 4 }),
  previous = position(0);
```

The _t_scale_ is going to translate time into a parameter, _x_ and _y_ calculate proper positions on the final image using the coordinates returned by the position function. We also put a simple circle on the image - this will represent the brush - and we need to take note of the previous position so we can draw lines between our current and previous state.

```javascript
var step = function (time) {
  if (time > t_scale.domain()[1]) {
    return true;
  }

  var t = t_scale(time),
    pos = position(t);

  brush.attr({ cx: x(pos.x), cy: y(pos.y) });
  svg.append("line").attr({
    x1: x(previous.x),
    y1: y(previous.y),
    x2: x(pos.x),
    y2: y(pos.y),
    stroke: "steelblue",
    "stroke-width": 1.3,
  });

  previous = pos;
};
```

This is our [step function](http://en.wikipedia.org/wiki/Step_function "Step function"). It draws every consecutive step of the animation by moving the brush and putting a line between the current and previous position. The animation will stop when this function returns _true_ so we make sure the _time_ parameter doesn't go beyond _t_scales_'s domain. Finally, we simply start the timer.

```javascript
var timer = d3.timer(step, 500);
```

\_**\_![]()![A parametric equation visualised](http://swizec.com/blog/wp-content/uploads/2013/03/0007_04_05.png "A parametric equation visualised")**![Glitchy spirograph](http://swizec.com/blog/wp-content/uploads/2013/03/glitchy-spirograph.png "Glitchy spirograph")

###### Related articles

- [![](http://i.zemanta.com/148486923_80_80.jpg)](http://www.universetoday.com/100325/the-vela-pulsar-as-a-spirograph/)[The Vela Pulsar as a Spirograph](http://www.universetoday.com/100325/the-vela-pulsar-as-a-spirograph/)
- [![](http://i.zemanta.com/147121686_80_80.jpg)](http://hackaday.com/2013/02/21/laser-spirograph/)[Laser Spirograph](http://hackaday.com/2013/02/21/laser-spirograph/)
- [![](http://i.zemanta.com/148806266_80_80.jpg)](http://www.gizmodo.co.uk/2013/02/watch-the-universe-draw-an-awesome-spirograph-in-the-sky/)[Watch the Universe Draw an Awesome Spirograph in the Sky](http://www.gizmodo.co.uk/2013/02/watch-the-universe-draw-an-awesome-spirograph-in-the-sky/)
- [![](http://i.zemanta.com/148576796_80_80.jpg)](http://phys.org/news/2013-02-fermi-motion-spirograph.html)[Fermi's motion produces a study in spirograph](http://phys.org/news/2013-02-fermi-motion-spirograph.html)

[![Enhanced by Zemanta](http://img.zemanta.com/zemified_e.png?x-id=fb22a411-7098-4367-b54c-e6363f006ad9)](http://www.zemanta.com/?px "Enhanced by Zemanta")
