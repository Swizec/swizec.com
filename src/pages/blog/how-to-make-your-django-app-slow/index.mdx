---
title: "How to make your django app slow"
description: ""
published: 2012-03-05
redirect_from:
  - /blog/how-to-make-your-django-app-slow/swizec/3825
categories: "django, Integration testing, Languages, Programming, python, TestUnit, Uncategorized"
hero: ../../../defaultHero.jpg
---

_![]()_![Nikon GP-1 GPS Unit Test](http://swizec.com/blog/wp-content/uploads/2012/03/3188032449_1e8783552a_m5.jpg "Nikon GP-1 GPS Unit Test")\_\_\_\_

## Context! I need context!

Let me give you a bit of context for what's going on:

- the project lets customers have many users
- users enter events when they do stuff
- the entries can be checked in a dashboard
- there is a date-range picker to see more than just today's events

And that's where it all gets ever so slightly weird. When you choose anything other than _today_ things start becoming increasingly slow and sometimes certain browsers decide that it's just too slow and timeout. No, it isn't slow enough to cause the 30 second socket timeout. No, caching wouldn't really benefit this activity either.

## A simple benchmark

In light of what I've learned about [unit testing being for lazy people](http://swizec.com/blog/unit-testing-is-for-lazy-people/swizec/3752 "Unit testing is for lazy people") last week, I decided to set up a [unit test](http://en.wikipedia.org/wiki/Unit_testing "Unit testing") that is actually an [integration test](http://en.wikipedia.org/wiki/Integration_testing "Integration testing") and most likely isn't either of those since it's some sort of benchmark. But it goes in [django](http://www.djangoproject.com "Django (Web framework)")'s testing framework, the python module behind that is called unittest, so I'm calling it a unit test.

```python
    def test_date_range(self):
        t1 = datetime.now()
        response = self.c.post('/accounts/dashboard/',
                               {'dateFrom': (datetime.now()-timedelta(days=356)).strftime("%m/%d/%Y")})

        t2 = datetime.now()

        self.assert_((t2-t1).seconds < 2, "Too slow")
```

See, simple test. All it needed was exporting the whole production database into a fixture so django loads it up every time the test is run and then cleans up after itself. The results are abominable! To return a dashboard with 250 rows of entries, this django app takes between **5 and 8** seconds. Clearly way way too much time!

## The fix?

**![U.S. Marine Corps SSgt. R. McIntosh, an engine...](http://swizec.com/blog/wp-content/uploads/2012/03/300px-Allison_T56_mobile_test_unit_MCAS_Futenma_19823.jpeg "U.S. Marine Corps SSgt. R. McIntosh, an engine...")****_\*\*\*\*\*\*\*\*_**

###### Related articles

- [Unit testing is for lazy people](http://swizec.com/blog/unit-testing-is-for-lazy-people/swizec/3752) (swizec.com)
- [Simple trick for testing forms full of checkboxes with django](http://swizec.com/blog/simple-trick-for-testing-forms-full-of-checkboxes-with-django/swizec/3098) (swizec.com)
- ["architect": we have big refactors to do on out architecture but first we need to unit test everything me: I'm all for finally](http://www.devsigh.com/sigh/424) (devsigh.com)
- [Django charfield queryset filter without escaping the MYSQL wildcard](http://stackoverflow.com/questions/8664551/django-charfield-queryset-filter-without-escaping-the-mysql-wildcard) (stackoverflow.com)
- [Do we still need django-nonrel now that GAE (allegedly) supports Django out of the box?](http://stackoverflow.com/questions/9065371/do-we-still-need-django-nonrel-now-that-gae-allegedly-supports-django-out-of-t) (stackoverflow.com)
- [Retrieving only the date part of a datetime column in Django](http://stackoverflow.com/questions/8698794/retrieving-only-the-date-part-of-a-datetime-column-in-django) (stackoverflow.com)
- [15 Key Resources to Learn Django](http://css.dzone.com/articles/15-key-resources-learn-django-0) (css.dzone.com)

[![Enhanced by Zemanta](http://img.zemanta.com/zemified_e.png?x-id=fee7947c-17cc-4d31-b348-c7a8b425b12c)](http://www.zemanta.com/ "Enhanced by Zemanta")
